<html>
    <head>
        {% load static %}
        <title>Shop Page</title>
        <link rel="icon" href="{% static 'aionApp/Images/watch.png' %}" type="image" sizes="16x16">
        <link rel="stylesheet" type="text/css" href="{% static 'aionApp/shop.css' %}">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    </head>
    
    <body>
        <div id="navbar">
            <p id="logo" style="position: absolute; left: -3%;">  
                {% if currentUser.user_id > 0 %}
                <a href="/aionApp/homePage/"><img src="{% static 'aionApp/Images/watch.png' %}" id="watch"></a>
                {% else %}
                <a href="/aionApp/exitSession/"><img src="{% static 'aionApp/Images/watch.png' %}" id="watch"></a>
                {% endif %}
                 AION
            </p>
            
            {% if currentUser.role_type != "0" %}
            <form class="searchContainer">
                <input type="text" id="searchBar" placeholder="SEARCH AION">
                <a href="#"><img class="searchIcon" src="{% static 'aionApp/Images/search.png' %}"></a>
            </form>
            {% endif %}
            
            {% if currentUser.user_id > 0 %}
                {% if currentUser.role_type != "0" %}
                    <span style="position: absolute; left: 47%;">
                        <a href="#"><img src="{% static 'aionApp/Images/cart.png' %}" id="cart"></a>
                        <a href="#">SHOP</a>
                        <a href="/aionApp/exitSession/">LOG OUT</a>    
                    </span>
                {% else %}
                    <span style="position: absolute; left: 70%;">
                        <a onclick="document.getElementById('addProductModal').style.display='block'">ADD PRODUCT</a>
                        <a href="/aionApp/exitSession/">LOG OUT</a>    
                    </span>
                {% endif %}
            {% else %}
            <span style="position: absolute; left: 55%;">
                <a href="#">SHOP</a>
                <a onclick="document.getElementById('loginModal').style.display='block'">LOG IN</a>
            </span>
            {% endif %}
        </div>
        
        <div id="loginModal" class="modal">
            <form class="modal-content animate" action="{% url 'aionApp:shopLogIn' %}" method = "post">
                {% csrf_token %}
                <div class="imgcontainer">
                    <span onclick="document.getElementById('loginModal').style.display='none'" class="close" title="Close Modal">&times;</span>
                </div>
                
                <div class="loginContainer">
                    <div class="spacer" style="margin-bottom: 1em;"> </div>
                    <input type="text" placeholder="USERNAME" name="userName" required>
                    <input type="password" placeholder="PASSWORD" name="userPassword" required>
                    <button type="submit" id="loginBtn">LOG IN</button>

                    {% if error %}
                    <div class="spacer" style="margin-bottom: 1em;"> </div>
                    <p id="error">Invalid user name or password.</p>
                    {% endif %}
                </div>

                <div class="loginContainer" id="logIn" style="background-color:#f1f1f1; height: 10%;">
                    <span class="psw">Don't have an account? <a href="/aionApp/registerPage/" class="aLogin">Sign up now.</a></span>
                </div>
            </form>
        </div>
        
        <div id="addProductModal" class="modal">
            <form class="addProductmodal-content animate"  action="{% url 'aionApp:addProduct' %}"method = "post">
                {% csrf_token %}
                <div class="imgcontainer">
                    <span onclick="document.getElementById('addProductModal').style.display='none'" class="close" title="Close Modal">&times;</span>
                </div>
                
                <div class="addProductContainer">
                    <div class="spacer" style="margin-bottom: 1em;"> </div>
                    <p class="addProductBigText">ADD A PRODUCT</p>
                    
                    <p class="addProductSmallText">NAME: <input id="nameInput" type="text" name="productName"/></p>
                    
                    <p class="addProductSmallText">DESCRIPTION:</p>
                    <textarea id="descriptionInput" name="productDescription"></textarea>
                    <br/>
                    <br/>
                    
                    <div class="col-md-6">
                        <p class="addProductSmallText">STOCK: <input id="stockInput" type="number" name="productStock" min="0"/></p>
                    </div>
                    
                    <div class="col-md-6">
                        <p class="addProductSmallText">PRICE: <input id="priceInput" type="number" name="productPrice" min="1"/></p>
                    </div>
                    
                    <p class="addProductSmallText" id="watchTypeText">WATCH TYPE: </p>
                    <select name="watchType" class="dropDown">
                        <option value="analog" selected>ANALOG WATCH</option>
                        <option value="digital">DIGITAL WATCH</option>    
                        <option value="smart">SMART WATCH</option>
                    </select>
                    
                    <div class="spacer" style="margin-bottom: 0.4em;"> </div>
                    
                    <p class="addProductSmallText">PICTURE:</p>
                    <input type="file" name="productPicture">
                    
                    
                    <div class="spacer" style="margin-bottom: 1em;"> </div>
                    
                    <button id="submitButton" href="#">SUBMIT</button>
                </div>

            </form>
        </div>
        
        <div id="shopContainer">
            <p id="bigMessage">ALL WATCHES</p>
            {% if addedProducts %}
                <div id="watchRow">
                {% for watches in addedProducts %}
                     <div class="inline-block" id="analogWatch" style="background-image: url({{ MEDIA_URL }}{{ watches.picture.url }})">
                        <span class="watchText"><a href="#" class="aWatch" onclick="openModal{{watches.id}}()">QUICK VIEW</a></span>
                    </div>
<!--
                    <p class="watchText" id ="alignWatchText">{{watches.name}}</p>
                        <p class="watchText" id="alignWatchText">${{watches.price}}</p>
-->
                    <div class="inline-block" style="margin-right: 5em;"> </div>
                {% endfor %}
                </div>
            {% endif %}
        </div>
        
        {% if addedProducts %}
        {% for watches in addedProducts %}
            <div id="watchModal{{watches.id}}" class="modal">
                <form class="watchModal-content animate" method = "post">
                    <div class="imgcontainer">
                        <span onclick="closeModal{{watches.id}}()" class="watchShop" title="Close Modal">&times;</span>
                    </div>

                    <div class="watchModalContainer">
                        <div class="spacer" style="margin-bottom: 1em;"> </div>
                        <div class="col-md-6">
                            <img src="{{ MEDIA_URL }}{{ watches.picture.url }}" id="watchImg">
                        </div>
                        <div class="col-md-6">
                            <p id="productName">{{watches.name}}</p>
                            <p id="description">{{watches.description}}</p>
                            <p id="price">${{watches.price}}</p>&nbsp;
                            {% if watches.stock <= 15 %}
                            <p id="stock">Only {{watches.stock}} left!</p>
                            {% endif %}
                            <p id="quantityText">QUANTITY</p>
                            <input id="quantity" type="number" value="1" name="quantity" min="1"/>
                            <br/>
                            <br/>
                            <br/>
                            {% if currentUser.user_id > 0 %}
                                <button id="addToCart" href="#">ADD TO CART</button>
                            {% endif %}
                        </div>
                    </div>
                </form>
            </div>
        {% endfor %}
        {% endif %}
        
        <footer>Copyright Â© 2018 Xcite Interactive. All Rights Reserved.</footer>
    </body>
    
    <script>
        {% if error %}
            $(document).ready(function() {
                $('#loginModal').modal('show');
            });
        {% endif %}
        
        function openModal() {          
            document.getElementById('watchModal').style.display='block'
        }
         
        function closeModal() {
            document.getElementById('watchModal').style.display='none'
        }
    </script>
    
    {% if addedProducts %}
        {% for watches in addedProducts %}
            <script>
                function openModal{{watches.id}}() {          
                document.getElementById('watchModal{{watches.id}}').style.display='block'
            }

            function closeModal{{watches.id}}() {
                document.getElementById('watchModal{{watches.id}}').style.display='none'
            }
            </script>
        {% endfor %}
    {% endif %}
</html>